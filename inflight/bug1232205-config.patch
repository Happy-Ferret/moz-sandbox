# HG changeset patch
# User Lars T Hansen <lhansen@mozilla.com>
# Date 1461420019 -7200
#      Sat Apr 23 16:00:19 2016 +0200
# Node ID 8761349b54ecd4655d7faea24620f1fcaeaa173a
# Parent  206edb6bb5ae98d66bc7630eeefbc89f736bd75b
Bug 1232205 - Wasm baseline: Disable SAB and SIMD, enable baseline

diff --git a/js/src/moz.build b/js/src/moz.build
--- a/js/src/moz.build
+++ b/js/src/moz.build
@@ -640,21 +640,21 @@ if CONFIG['MOZ_ETW']:
         'ETWProvider.h',
     ]
     # This will get the ETW provider resources into the library mozjs.dll
     RESFILE = 'ETWProvider.res'
 
 if CONFIG['NIGHTLY_BUILD']:
     DEFINES['ENABLE_BINARYDATA'] = True
 
-if CONFIG['NIGHTLY_BUILD']:
-    DEFINES['ENABLE_SIMD'] = True
+#if CONFIG['NIGHTLY_BUILD']:
+#    DEFINES['ENABLE_SIMD'] = True
 
 # Also set in shell/moz.build
-DEFINES['ENABLE_SHARED_ARRAY_BUFFER'] = True
+#DEFINES['ENABLE_SHARED_ARRAY_BUFFER'] = True
 
 DEFINES['EXPORT_JS_API'] = True
 
 DEFINES['JS_WASM_BASELINE_BOOTSTRAP'] = True
 
 if CONFIG['JS_HAS_CTYPES']:
     DEFINES['JS_HAS_CTYPES'] = True
     for var in ('DLL_PREFIX', 'DLL_SUFFIX'):
diff --git a/js/src/shell/moz.build b/js/src/shell/moz.build
--- a/js/src/shell/moz.build
+++ b/js/src/shell/moz.build
@@ -15,17 +15,17 @@ UNIFIED_SOURCES += [
     'jsoptparse.cpp',
     'jsshell.cpp',
     'OSObject.cpp'
 ]
 
 DEFINES['EXPORT_JS_API'] = True
 
 # Also set in ../moz.build
-DEFINES['ENABLE_SHARED_ARRAY_BUFFER'] = True
+#DEFINES['ENABLE_SHARED_ARRAY_BUFFER'] = True
 
 if CONFIG['_MSC_VER']:
     # unnecessary PGO for js shell.  But gcc cannot turn off pgo because it is
     # necessary to link PGO lib on gcc when a object/static lib are compiled
     # for PGO.
     NO_PGO = True
 
 LOCAL_INCLUDES += [
